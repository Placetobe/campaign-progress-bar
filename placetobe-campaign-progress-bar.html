<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../placetobe-styles/placetobe-styles.html">

<!--
`placetobe-campaign-progress-bar`
Placetobe Campaign Progress Bar

@demo demo/index.html 
-->

<dom-module id="placetobe-campaign-progress-bar">
  <template>
    <style>
      :host {
        display: block;
      }

      :host section {
        display: flex;
        flex-direction: column;
      }

      :host([text-below]) section {
        flex-direction: column-reverse;
      }

      :host section .container.
      :host section h6 {
        flex: 1;
      }

      :host .container {
        background-color: var(--placetobe-campaign-progress-bar-background-color, white);
        height: 9px;
        width: 100%;
        border-radius: 8px;
        box-sizing: border-box;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        -ms-box-sizing: border-box;
        -o-box-sizing: border-box;
      }

      :host #progress-bar {
        background-color: var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
        height: 100%;
        position: relative;
        border-radius: 8px;
      }

      :host #progress-bar:after {
        position: absolute;
        width: 17px;
        height: 17px;
        right: -9px;
        top: -4px;
        content: "";
        border-radius: 50%;
        background-color: var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
      }

      :host h6 {
        @apply(--placetobe-font-body-serif-small);
        color: var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
        margin: 6px 0;
      }
    </style>

    <section>
      <h6>[[currentlyFundedPercentage]]% behaald</h6>
      <div class="container">
        <div id="progress-bar" style$="width:[[_progressBarPercentage]]%;"></div>
      </div>
    </section>


  </template>

  <script>
    Polymer({

      is: 'placetobe-campaign-progress-bar',

      properties: {

        /*
        The currently funded capital
        */
        currentlyFunded: {
          type: Number,
          value: 0
        },

        /*
        The required funded capital
        */
        requiredFunding: {
          type: Number,
          value: 0
        },

        /*
        The maximum funded capital
        */
        maximumFunding: {
          type: Number,
          value: 0
        },

        /*
        Exposes the currently funded capital, as a percentage related to `required-funding`
        */
        currentlyFundedPercentage: {
          type: Number,
          notify: true,
          computed: '_computePercentageFundedPercentage(currentlyFunded, requiredFunding)'
        },

        /*
        If true, the text label is placed below the progress bar
        */
        textBelow: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        },

        _progressBarPercentage: {
          type: Number,
          computed: '_computeProgressBarPercentage(currentlyFunded, requiredFunding, maximumFunding)'
        }

      },

      _computePercentageFundedPercentage: function(currentlyFunded, requiredFunding) {
        if(! (currentlyFunded && requiredFunding) ) return 0;
        return Math.floor(currentlyFunded / requiredFunding * 100);
      },

      _computeProgressBarPercentage: function(currentlyFunded, requiredFunding, maximumFunding) {
        if(!maximumFunding) return this.currentlyFundedPercentage;
        if(! (currentlyFunded && maximumFunding) ) return 0;
        return Math.floor(currentlyFunded / maximumFunding * 100);        
      }

    });
  </script>
</dom-module>
