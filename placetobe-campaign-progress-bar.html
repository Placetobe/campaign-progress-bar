<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../placetobe-styles/placetobe-styles.html">
<link rel="import" href="../placetobe-behaviors/placetobe-styles-behavior.html">
<link rel="import" href="../paper-slider/paper-slider.html">

<!--
`placetobe-campaign-progress-bar`
Placetobe Campaign Progress Bar

@demo demo/index.html 
-->

<dom-module id="placetobe-campaign-progress-bar">
  <template>
    <style>
      :host {
        display: block;
      }

      :host section {
        @apply(--placetobe-flex-layout--vertical)
      }

      :host([text-below]) section {
        @apply(--placetobe-flex-layout--vertical-reverse)
      }

      #slider-container {
        width: 100%;
        @apply --placetobe-flex-layout;
        @apply --placetobe-flex-layout--horizontal;
      }

      :host section h6 {
        @apply(--placetobe-flex-item--1);
      }

      :host h6 {
        @apply(--placetobe-font-body-serif);
        font-size: var(--placetobe-font-body-size--small);
        color: var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
        margin: 0;
      }

      :host paper-slider {
        margin-left: calc(-15px + calc(calc(var(--placetobe-margin)/4))*-1);
        margin-right: calc(-15px + calc(calc(var(--placetobe-margin)/4))*-1);
        @apply --placetobe-flex-item--1;

        --paper-slider-knob-start-color: var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
        --paper-slider-disabled-active-color: var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
        --paper-slider-disabled-knob-color: var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
        --paper-slider-container-color: var(--placetobe-campaign-progress-bar-background-color, white);
        --paper-slider-height: calc(var(--placetobe-margin)/2);
        --paper-slider-pin-start-color: red;
        --paper-slider-knob-start-border-color: var(--placetobe-campaign-progress-bar-background-color, white);
        --paper-slider-knob-color: var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
        --paper-slider-pin-start-color:var(--placetobe-campaign-progress-bar-tint-color, var(--placetobe-color-green));
      }
    </style>

    <section>
      <h6>[[currentlyFundedPercentage]]% behaald</h6>
      <div id="slider-container">
        <paper-slider
          min="0"
          max="100"
          value="[[_progressBarPercentage]]"
          immediate-value="[[_progressBarPercentage]]"
          disabled
        ></paper-slider>
      </div>
      
    </section>
  </template>

  <script>
    Polymer({

      is: 'placetobe-campaign-progress-bar',
      behaviors: [PlacetobeStylesBehavior],

      properties: {

        /*
        The currently funded capital
        */
        currentlyFunded: {
          type: Number,
          value: 0
        },

        /*
        The required funded capital
        */
        requiredFunding: {
          type: Number,
          value: 0
        },

        /*
        The maximum funded capital
        */
        maximumFunding: {
          type: Number,
          value: 0
        },

        /*
        Exposes the currently funded capital, as a percentage related to `required-funding`
        */
        currentlyFundedPercentage: {
          type: Number,
          notify: true,
          computed: '_computePercentageFundedPercentage(currentlyFunded, requiredFunding)'
        },

        /*
        If true, the text label is placed below the progress bar
        */
        textBelow: {
          type: Boolean,
          value: false,
          reflectToAttribute: true
        },

        _progressBarPercentage: {
          type: Number,
          computed: '_computeProgressBarPercentage(currentlyFunded, requiredFunding, maximumFunding)'
        }

      },

      _computePercentageFundedPercentage: function(currentlyFunded, requiredFunding) {
        if(! (currentlyFunded && requiredFunding) ) return 0;
        return Math.floor(currentlyFunded / requiredFunding * 100);
      },

      _computeProgressBarPercentage: function(currentlyFunded, requiredFunding, maximumFunding) {
        if(!maximumFunding) return this.currentlyFundedPercentage;
        if(! (currentlyFunded && maximumFunding) ) return 0;
        return Math.floor(currentlyFunded / maximumFunding * 100);        
      }

    });
  </script>
</dom-module>